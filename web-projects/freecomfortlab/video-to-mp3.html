<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì¼ë°˜ ì˜ìƒ MP3 ë³€í™˜ - FreeComfortLab</title>
  <style>
    :root {
      --bg-gradient: linear-gradient(120deg, #e0c3fc 0%, #c2e9fb 100%);
      --glass-bg: rgba(255, 255, 255, 0.85);
      --glass-border: 1px solid rgba(255, 255, 255, 0.9);
      --text-main: #2c3e50;
      --accent: #6c5ce7;
    }
    body {
      font-family: system-ui, sans-serif; background: var(--bg-gradient);
      color: var(--text-main); margin: 0; padding: 20px; min-height: 100vh;
      display: flex; justify-content: center; align-items: center;
    }
    .card {
      background: var(--glass-bg); backdrop-filter: blur(12px);
      border: var(--glass-border); border-radius: 24px; padding: 32px;
      width: 100%; max-width: 500px; box-shadow: 0 10px 40px rgba(0,0,0,0.05);
    }
    h1 { font-size: 20px; margin-bottom: 8px; color: #2d3436; }
    p.desc { font-size: 14px; color: #636e72; margin-bottom: 24px; line-height: 1.5; }
    
    .upload-box {
      border: 2px dashed #b2bec3; border-radius: 16px; padding: 30px;
      text-align: center; margin-bottom: 20px; transition: 0.2s; background: rgba(255,255,255,0.5);
    }
    .upload-box:hover { border-color: var(--accent); background: rgba(255,255,255,0.8); }
    
    .btn {
      width: 100%; padding: 14px; border-radius: 12px; border: none;
      background: var(--accent); color: white; font-weight: 700; font-size: 15px;
      cursor: pointer; transition: 0.2s;
    }
    .btn:hover { background: #5649c0; transform: translateY(-2px); }
    .btn:disabled { background: #b2bec3; cursor: default; }
    
    .status { margin-top: 16px; font-size: 13px; text-align: center; }
    .back-link { display: block; text-align: center; margin-top: 20px; font-size: 13px; color: #636e72; text-decoration: none; }
  </style>
</head>
<body>
  <div class="card">
    <h1>ğŸ“¹ ì¼ë°˜ ì˜ìƒ â†’ MP3 ë³€í™˜</h1>
    <p class="desc">ì˜í™”, ìœ íŠœë¸Œ ë‹¤ìš´ë¡œë“œ ì˜ìƒ ë“± ëª¨ë“  ë™ì˜ìƒ íŒŒì¼ì—ì„œ<br>ì˜¤ë””ì˜¤ë§Œ ì¶”ì¶œí•˜ì—¬ MP3ë¡œ ì €ì¥í•©ë‹ˆë‹¤.</p>
    
    <div class="upload-box" id="dropArea">
      <div style="font-size: 32px; margin-bottom: 10px;">ğŸ“€</div>
      <p id="fileName" style="font-size:14px; color:#636e72;">í´ë¦­í•´ì„œ ë™ì˜ìƒ íŒŒì¼ ì„ íƒ</p>
      <input type="file" id="fileInput" accept="video/*" style="display:none">
    </div>

    <button id="btnConvert" class="btn">ì˜¤ë””ì˜¤ ì¶”ì¶œí•˜ê¸°</button>
    <div id="statusBox" class="status"></div>
    
    <a href="index.html" class="back-link">â† ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
  </div>

  <script>
    const TYPE = "video-to-mp3";
    const fileInput = document.getElementById("fileInput");
    const dropArea = document.getElementById("dropArea");
    const fileName = document.getElementById("fileName");
    const btn = document.getElementById("btnConvert");
    const status = document.getElementById("statusBox");
    let file = null;

    dropArea.addEventListener("click", () => fileInput.click());
    fileInput.addEventListener("change", (e) => {
      if(e.target.files[0]) {
        file = e.target.files[0];
        fileName.textContent = "âœ… " + file.name;
        fileName.style.color = "#2d3436";
        fileName.style.fontWeight = "bold";
      }
    });

    btn.addEventListener("click", async () => {
      if(!file) return alert("íŒŒì¼ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”!");
      btn.disabled = true;
      btn.textContent = "ì¶”ì¶œ ì¤‘...";
      status.textContent = "ì„œë²„ë¡œ ì „ì†¡í•˜ì—¬ ì˜¤ë””ì˜¤ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤...";
      
      try {
        const formData = new FormData();
        formData.append("file", file);
        formData.append("type", TYPE);
        
        const res = await fetch("/api/convert", { method: "POST", body: formData });
        if(!res.ok) throw new Error("ë³€í™˜ ì‹¤íŒ¨");
        
        const blob = await res.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "extracted_audio.mp3";
        a.click();
        
        status.textContent = "ğŸ‰ ì™„ë£Œ! MP3ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.";
        status.style.color = "#00b894";
        btn.textContent = "ì„±ê³µ";
      } catch(err) {
        status.textContent = "ì‹¤íŒ¨: " + err.message;
        status.style.color = "#d63031";
        btn.disabled = false;
        btn.textContent = "ë‹¤ì‹œ ì‹œë„";
      }
    });
  </script>
</body>
</html>
